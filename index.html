
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>å°ä¸€ Â· TRTC æ‹¨å·å™¨ï¼ˆä¿®æ­£ç‰ˆï¼‰</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f5f5f5; }
    h1 { text-align: center; }
    .group { margin: 10px 0; }
    input { width: 100%; padding: 8px; box-sizing: border-box; }
    button { width: 100%; margin-top: 10px; padding: 10px; background: #0066ff; color: #fff; border: none; }
    #log { margin-top: 20px; padding: 10px; background: #fff; height: 150px; overflow-y: auto; white-space: pre-wrap; }
  </style>
</head>
<body>
  <h1>å°ä¸€ Â· TRTC æ‹¨å·å™¨ï¼ˆä¿®æ­£ç‰ˆï¼‰</h1>

  <div class="group">
    <label>SDKAppID</label>
    <input id="sdkappid" value="1600096672">
  </div>
  <div class="group">
    <label>UserSig</label>
    <input id="usersig" value="8c7b53c38ab10c025c2c5236130f9809aaafc4240d3463ee41d0288c6b183147">
  </div>
  <div class="group">
    <label>æˆ¿é—´å·</label>
    <input id="roomid" value="1001">
  </div>
  <div class="group">
    <label>ç”¨æˆ·ID</label>
    <input id="userid" value="xiaoyi">
  </div>
  <div class="group">
    <label>ç”µè¯å·ç ï¼ˆPSTN æ‹¨å·ï¼‰</label>
    <input id="phonenumber" value="13800138000">
  </div>

  <button id="joinBtn">åŠ å…¥è¯­éŸ³æˆ¿é—´</button>
  <button id="callBtn">æ‹¨æ‰“ç”µè¯</button>

  <div id="log"></div>

  <script src="https://liteav.sdk.qcloud.com/trtc/webrtc/trtc.min.js"></script>
  <script>
    const logEl = document.getElementById('log');
    function log(msg) {
      logEl.textContent += msg + "\n";
      logEl.scrollTop = logEl.scrollHeight;
    }

    let client = null;

    document.getElementById('joinBtn').onclick = async () => {
      const sdkAppId = parseInt(document.getElementById('sdkappid').value);
      const userSig  = document.getElementById('usersig').value.trim();
      const userId   = document.getElementById('userid').value.trim();
      const roomId   = parseInt(document.getElementById('roomid').value);

      if (!sdkAppId || !userSig || !userId || !roomId) {
        return alert('è¯·å¡«å†™ SDKAppIDã€UserSigã€ç”¨æˆ·IDã€æˆ¿é—´å·');
      }

      try {
        client = TRTC.createClient({ mode: 'rtc', sdkAppId, userId, userSig });
        await client.join({ roomId });
        log(`âœ… å·²åŠ å…¥æˆ¿é—´ ${roomId}`);
      } catch (e) {
        log(`âŒ åŠ å…¥æˆ¿é—´å¤±è´¥ï¼š${e.message}`);
      }
    };

    document.getElementById('callBtn').onclick = async () => {
      if (!client) {
        return alert('è¯·å…ˆåŠ å…¥è¯­éŸ³æˆ¿é—´');
      }
      const phone = document.getElementById('phonenumber').value.trim();
      if (!phone) {
        return alert('è¯·å¡«å†™è¦æ‹¨æ‰“çš„ç”µè¯å·ç ');
      }

      try {
        await client.call({ type: 'pstn', callee: phone, country: '86' });
        log(`ğŸ“ æ­£åœ¨æ‹¨æ‰“ ${phone}`);
      } catch (e) {
        log(`âŒ æ‹¨å·å¤±è´¥ï¼š${e.message}`);
      }
    };
  </script>
</body>
</html>
